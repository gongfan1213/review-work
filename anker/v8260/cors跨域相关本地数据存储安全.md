# 5.1.3cors
- cors跨域资源共享是一种机制，他是使用额外的http头来告诉浏览器运行web应用从不同的域，协议+域名+端口请求资源，cors可以防止某些类型的跨站请求伪造csrf攻击，并且确保只有在被授权的域可以访问资源
- cors通过在http请求和响应当中添加特点的头来实现跨域资源共享，
- 1.预检请求preflight request
- 对于某些类型的跨域请求，比如使用非简单方法或者自定义的头，浏览器会先发送一个options请求，称之为预检请求。来确定服务器是否允许该跨域请求
- 服务器响应预检请求，回包含access-control-allow-origin，access-control-allow- methods，access-control-allow-heeaders等等，指示允许的跨域请求的域方法和头
- 2.实际请求actual request
- 如果预检请求通过，浏览器会发送实际的请求，服务器响应的时候会包含access-control-allow-origin的头，指示运行的跨域请求的域
# 2d编辑器的项目问题
- 选择画布的时候可以加载画布底层，但是在canvas当中加载不了底层，报错画布图片的跨域，当前并不支持
- 1.img标签：用于在网页上显示图像，浏览器允许你使用img标签从任何来源加载图像，即使是跨域的，这是因为图像本身不会泄漏源信息，并且图像的时候被认为是低风险的
- canvas元素，用于图形的绘制和图像处理，当你试图在cnvas上使用跨域图像的数据的时候，同源策略会生效的，如果canvas操作涉及到跨域数据，浏览器会将其标记为脏，并且限制为图像数据的进一步访问，这是因为canvas可以用来读取和操作图像数据，可能会泄漏敏感信息，因此需要更加严格的安全措施
- 在项目当中selectdialog加载画布，直接使用img标签加载，这个时候img并没有设置crossOrigin属性，但是因为img标签不受同源策略的限制，可以正常加载的，然后canvas去加载同一张图片，这个时候从缓存当中获取，缓存当中的谁并没有corssorigin属性，所以canvas加载失败，报错同源限制的
- 缓存当中数据没有crossOrigin属性，所以canvas加载会是失败的，报错同源的限制

# 项目当中的处理
- 1.图像服务器必须设置cors跨域资源共享，响应头，允许你的域名访问图像资源
- 2.在前端代码当中，当创建img标签或者使用image/canvas对象加载图像的时候，需要设置corssOrigin属性为anonyous，这个告诉浏览器在请求图像的时候不发送用户凭证
- 修改的是，在img标签都设置corssOrigin属性anonymous同时注意如果canvas单独使用img图片，需要添加crossOrigin属性
# 5.2本地存储安全
- web端本次存储使用localstorage保存，数据包括两个部分，用户信息和设置信息，需要对本地存储数据进行加密处理竞品没有加密措施，当前mkitreal针对用户信息进行加密，其他信息在世不加密

- web端调用localstorage接口-》数据获取-〉得到key-》获取aes密钥——〉解密数据
- web端调用localstorage接口->数据编辑-》获取aeskey加密-〉存储加密后的数据

# 5.3用户隐私安全
# 5.4浏览器应用安全
- 爱加密移动应用安全加固平台提供h5文件加固，微信小程序加固，同时提供多种加固策略，更加便捷的运作，保存控制台的日志控制，防止篡改确保代码的完整性
- 开发点击构建计划-》构建打包-〉的到应用包->上传爱加密加固-》的到加固包——〉上传制品平台->部署对应的环境


### 加固策略
1. **常量交换**
   - **策略说明**：将代码中的常量（如字符、数字）替换为复合的表达式或计算过程，以防止通过简单搜索来定位和修改这些值。

2. **二维表达式替换**
   - **策略说明**：使用等效的二维表达式来替换简单的表达式，增加代码的复杂度，使得理解和修改代码更为困难。

3. **函数名变量名混淆**
   - **策略说明**：将函数名称和变量名称替换为无意义的字符组合，例如随机和数字，以避免暴露代码逻辑和功能。

4. **禁止控制台输出**
   - **策略说明**：移除或禁用 `console.log` 和其他控制台输出，以防止敏感信息泄露和调试。

5. **控制流程扁平化**
   - **策略说明**：将代码中的控制流（如 `if-else`、循环）转换为更复杂的结构，以阻碍代码的理解和分析，建议仅对一级函数进行平坦化，以减少混淆效果和性能影响。

6. **字符串串加密**
   - **策略说明**：将代码中字符串的字符常量加密，并在运行时解密，以防止通过搜索字符串来理解代码逻辑。

7. **代码压缩**
   - **策略说明**：移除代码中的空白、换行，缩短变量名，并减少文件大小和提高加载速度。这是一种跨平台的优化，兼容性强，支持新语言的语法。

8. **防篡改**
   - **策略说明**：通过校验签名和机制检测代码是否被修改，以确保代码的完整性。 

